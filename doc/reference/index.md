
# NHibernate - Relational Persistence for Idiomatic .NET
## NHibernate Reference Documentation
### 5.1

**Table of Contents**

* [Preface](preface.md#preface)
* [Quick-start with IIS and Microsoft SQL Server](quickstart.md#quick-start-with-iis-and-microsoft-sql-server)
   * [Getting started with NHibernate](quickstart.md#getting-started-with-nhibernate)
   * [First persistent class](quickstart.md#first-persistent-class)
   * [Mapping the cat](quickstart.md#mapping-the-cat)
   * [Playing with cats](quickstart.md#playing-with-cats)
   * [Finally](quickstart.md#finally)
* [Architecture](architecture.md#architecture)
   * [Overview](architecture.md#overview)
   * [Instance states](architecture.md#instance-states)
   * [Contextual Sessions](architecture.md#contextual-sessions)
* [ISessionFactory Configuration](session-configuration.md#isessionfactory-configuration)
   * [Programmatic Configuration](session-configuration.md#programmatic-configuration)
   * [Obtaining an ISessionFactory](session-configuration.md#obtaining-an-isessionfactory)
   * [User provided ADO.NET connection](session-configuration.md#user-provided-adonet-connection)
   * [NHibernate provided ADO.NET connection](session-configuration.md#nhibernate-provided-adonet-connection)
   * [Optional configuration properties](session-configuration.md#optional-configuration-properties)
      * [SQL Dialects](session-configuration.md#sql-dialects)
      * [Outer Join Fetching](session-configuration.md#outer-join-fetching)
      * [Custom ICacheProvider](session-configuration.md#custom-icacheprovider)
      * [Query Language Substitution](session-configuration.md#query-language-substitution)
   * [Logging](session-configuration.md#logging)
   * [Implementing an INamingStrategy](session-configuration.md#implementing-an-inamingstrategy)
   * [XML Configuration File](session-configuration.md#xml-configuration-file)
* [Persistent Classes](persistent-classes.md#persistent-classes)
   * [A simple POCO example](persistent-classes.md#a-simple-poco-example)
      * [Declare properties for persistent fields](persistent-classes.md#declare-properties-for-persistent-fields)
      * [Implement a default constructor](persistent-classes.md#implement-a-default-constructor)
      * [Provide an identifier property (optional)](persistent-classes.md#provide-an-identifier-property-optional)
      * [Prefer non-sealed classes and virtual methods (optional)](persistent-classes.md#prefer-non-sealed-classes-and-virtual-methods-optional)
   * [Implementing inheritance](persistent-classes.md#implementing-inheritance)
   * [Implementing Equals() and GetHashCode()](persistent-classes.md#implementing-equals-and-gethashcode)
   * [Dynamic models](persistent-classes.md#dynamic-models)
   * [Tuplizers](persistent-classes.md#tuplizers)
   * [Lifecycle Callbacks](persistent-classes.md#lifecycle-callbacks)
   * [IValidatable callback](persistent-classes.md#ivalidatable-callback)
* [Basic O/R Mapping](mapping.md#basic-or-mapping)
   * [Mapping declaration](mapping.md#mapping-declaration)
      * [XML Namespace](mapping.md#xml-namespace)
      * [hibernate-mapping](mapping.md#hibernate-mapping)
      * [class](mapping.md#class)
      * [subselect](mapping.md#subselect)
      * [id](mapping.md#id)
         * [generator](mapping.md#generator)
         * [Hi/Lo Algorithm](mapping.md#hilo-algorithm)
         * [UUID Hex Algorithm](mapping.md#uuid-hex-algorithm)
         * [UUID String Algorithm](mapping.md#uuid-string-algorithm)
         * [GUID Algorithms](mapping.md#guid-algorithms)
         * [Identity columns and Sequences](mapping.md#identity-columns-and-sequences)
         * [Assigned Identifiers](mapping.md#assigned-identifiers)
         * [Enhanced identifier generators](mapping.md#enhanced-identifier-generators)
            * [Identifier generator optimization](mapping.md#identifier-generator-optimization)
      * [composite-id](mapping.md#composite-id)
      * [discriminator](mapping.md#discriminator)
      * [version (optional)](mapping.md#version-optional)
      * [timestamp (optional)](mapping.md#timestamp-optional)
      * [property](mapping.md#property)
      * [many-to-one](mapping.md#many-to-one)
      * [one-to-one](mapping.md#one-to-one)
      * [natural-id](mapping.md#natural-id)
      * [component, dynamic-component](mapping.md#component-dynamic-component)
      * [properties](mapping.md#properties)
      * [subclass](mapping.md#subclass)
      * [joined-subclass](mapping.md#joined-subclass)
      * [union-subclass](mapping.md#union-subclass)
      * [join](mapping.md#join)
      * [map, set, list, bag](mapping.md#map-set-list-bag)
      * [import](mapping.md#import)
   * [NHibernate Types](mapping.md#nhibernate-types)
      * [Entities and values](mapping.md#entities-and-values)
      * [Basic value types](mapping.md#basic-value-types)
      * [Custom value types](mapping.md#custom-value-types)
      * [Any type mappings](mapping.md#any-type-mappings)
   * [SQL quoted identifiers](mapping.md#sql-quoted-identifiers)
   * [Modular mapping files](mapping.md#modular-mapping-files)
   * [Generated Properties](mapping.md#generated-properties)
   * [Auxiliary Database Objects](mapping.md#auxiliary-database-objects)
* [Collection Mapping](collections.md#collection-mapping)
   * [Persistent Collections](collections.md#persistent-collections)
   * [Mapping a Collection](collections.md#mapping-a-collection)
   * [Collections of Values and Many-To-Many Associations](collections.md#collections-of-values-and-many-to-many-associations)
   * [One-To-Many Associations](collections.md#one-to-many-associations)
   * [Lazy Initialization](collections.md#lazy-initialization)
   * [Sorted Collections](collections.md#sorted-collections)
   * [Using an &lt;idbag&gt;](collections.md#using-an-idbag)
   * [Bidirectional Associations](collections.md#bidirectional-associations)
   * [Bidirectional associations with indexed collections](collections.md#bidirectional-associations-with-indexed-collections)
   * [Ternary Associations](collections.md#ternary-associations)
   * [Heterogeneous Associations](collections.md#heterogeneous-associations)
   * [Collection examples](collections.md#collection-examples)
* [Component Mapping](components.md#component-mapping)
   * [Dependent objects](components.md#dependent-objects)
   * [Collections of dependent objects](components.md#collections-of-dependent-objects)
   * [Components as IDictionary indices](components.md#components-as-idictionary-indices)
   * [Components as composite identifiers](components.md#components-as-composite-identifiers)
   * [Dynamic components](components.md#dynamic-components)
* [Inheritance Mapping](inheritance.md#inheritance-mapping)
   * [The Three Strategies](inheritance.md#the-three-strategies)
      * [Table per class hierarchy](inheritance.md#table-per-class-hierarchy)
      * [Table per subclass](inheritance.md#table-per-subclass)
      * [Table per subclass, using a discriminator](inheritance.md#table-per-subclass-using-a-discriminator)
      * [Mixing table per class hierarchy with table per subclass](inheritance.md#mixing-table-per-class-hierarchy-with-table-per-subclass)
      * [Table per concrete class](inheritance.md#table-per-concrete-class)
      * [Table per concrete class, using implicit polymorphism](inheritance.md#table-per-concrete-class-using-implicit-polymorphism)
      * [Mixing implicit polymorphism with other inheritance mappings](inheritance.md#mixing-implicit-polymorphism-with-other-inheritance-mappings)
   * [Limitations](inheritance.md#limitations)
* [Manipulating Persistent Data](manipulatingdata.md#manipulating-persistent-data)
   * [Creating a persistent object](manipulatingdata.md#creating-a-persistent-object)
   * [Loading an object](manipulatingdata.md#loading-an-object)
   * [Querying](manipulatingdata.md#querying)
      * [Scalar queries](manipulatingdata.md#scalar-queries)
      * [The IQuery interface](manipulatingdata.md#the-iquery-interface)
      * [Filtering collections](manipulatingdata.md#filtering-collections)
      * [Criteria queries](manipulatingdata.md#criteria-queries)
      * [Queries in native SQL](manipulatingdata.md#queries-in-native-sql)
   * [Updating objects](manipulatingdata.md#updating-objects)
      * [Updating in the same ISession](manipulatingdata.md#updating-in-the-same-isession)
      * [Updating detached objects](manipulatingdata.md#updating-detached-objects)
      * [Reattaching detached objects](manipulatingdata.md#reattaching-detached-objects)
   * [Deleting persistent objects](manipulatingdata.md#deleting-persistent-objects)
   * [Flush](manipulatingdata.md#flush)
   * [Checking dirtiness](manipulatingdata.md#checking-dirtiness)
   * [Ending a Session](manipulatingdata.md#ending-a-session)
      * [Flushing the Session](manipulatingdata.md#flushing-the-session)
      * [Committing the database transaction](manipulatingdata.md#committing-the-database-transaction)
      * [Closing the ISession](manipulatingdata.md#closing-the-isession)
   * [Exception handling](manipulatingdata.md#exception-handling)
   * [Lifecycles and object graphs](manipulatingdata.md#lifecycles-and-object-graphs)
   * [Interceptors](manipulatingdata.md#interceptors)
   * [Metadata API](manipulatingdata.md#metadata-api)
* [Read-only entities](#read-only-entities)
   * [Making persistent entities read-only](#making-persistent-entities-read-only)
      * [Entities of immutable classes](#entities-of-immutable-classes)
      * [Loading persistent entities as read-only](#loading-persistent-entities-as-read-only)
      * [Loading read-only entities from an HQL query/criteria](#loading-read-only-entities-from-an-hql-querycriteria)
      * [Making a persistent entity read-only](#making-a-persistent-entity-read-only)
   * [Read-only affect on property type](#read-only-affect-on-property-type)
      * [Simple properties](#simple-properties)
      * [Unidirectional associations](#unidirectional-associations)
         * [Unidirectional one-to-one and many-to-one](#unidirectional-one-to-one-and-many-to-one)
         * [Unidirectional one-to-many and many-to-many](#unidirectional-one-to-many-and-many-to-many)
      * [Bidirectional associations](#bidirectional-associations)
         * [Bidirectional one-to-one](#bidirectional-one-to-one)
         * [Bidirectional one-to-many/many-to-one](#bidirectional-one-to-manymany-to-one)
         * [Bidirectional many-to-many](#bidirectional-many-to-many)
* [Transactions And Concurrency](transactions.md#transactions-and-concurrency)
   * [Configurations, Sessions and Factories](transactions.md#configurations-sessions-and-factories)
   * [Threads and connections](transactions.md#threads-and-connections)
   * [Considering object identity](transactions.md#considering-object-identity)
   * [Optimistic concurrency control](transactions.md#optimistic-concurrency-control)
      * [Long session with automatic versioning](transactions.md#long-session-with-automatic-versioning)
      * [Many sessions with automatic versioning](transactions.md#many-sessions-with-automatic-versioning)
      * [Customizing automatic versioning](transactions.md#customizing-automatic-versioning)
      * [Application version checking](transactions.md#application-version-checking)
   * [Session disconnection](transactions.md#session-disconnection)
   * [Pessimistic Locking](transactions.md#pessimistic-locking)
   * [Connection Release Modes](transactions.md#connection-release-modes)
   * [Transaction scopes (System.Transactions)](transactions.md#transaction-scopes-systemtransactions)
* [Interceptors and events](events.md#interceptors-and-events)
   * [Interceptors](events.md#interceptors)
   * [Event system](events.md#event-system)
* [Batch processing](batch.md#batch-processing)
   * [Batch inserts](batch.md#batch-inserts)
   * [The StatelessSession interface](batch.md#the-statelesssession-interface)
   * [DML-style operations](batch.md#dml-style-operations)
* [HQL: The Hibernate Query Language](queryhql.md#hql-the-hibernate-query-language)
   * [Case Sensitivity](queryhql.md#case-sensitivity)
   * [The from clause](queryhql.md#the-from-clause)
   * [Associations and joins](queryhql.md#associations-and-joins)
   * [The select clause](queryhql.md#the-select-clause)
   * [Aggregate functions](queryhql.md#aggregate-functions)
   * [Polymorphic queries](queryhql.md#polymorphic-queries)
   * [The where clause](queryhql.md#the-where-clause)
   * [Expressions](queryhql.md#expressions)
   * [The order by clause](queryhql.md#the-order-by-clause)
   * [The group by clause](queryhql.md#the-group-by-clause)
   * [Sub-queries](queryhql.md#sub-queries)
   * [HQL examples](queryhql.md#hql-examples)
   * [Tips &amp; Tricks](queryhql.md#tips--tricks)
* [Criteria Queries](querycriteria.md#criteria-queries)
   * [Creating an ICriteria instance](querycriteria.md#creating-an-icriteria-instance)
   * [Narrowing the result set](querycriteria.md#narrowing-the-result-set)
   * [Ordering the results](querycriteria.md#ordering-the-results)
   * [Associations](querycriteria.md#associations)
   * [Join entities without association (Entity joins or ad hoc joins)](querycriteria.md#join-entities-without-association-entity-joins-or-ad-hoc-joins)
   * [Dynamic association fetching](querycriteria.md#dynamic-association-fetching)
   * [Projections, aggregation and grouping](querycriteria.md#projections-aggregation-and-grouping)
   * [Detached queries and sub-queries](querycriteria.md#detached-queries-and-sub-queries)
* [QueryOver Queries](queryqueryover.md#queryover-queries)
   * [Structure of a Query](queryqueryover.md#structure-of-a-query)
   * [Simple Expressions](queryqueryover.md#simple-expressions)
   * [Additional Restrictions](queryqueryover.md#additional-restrictions)
   * [Associations](queryqueryover.md#associations)
   * [Join entities without association (Entity joins or ad hoc joins)](queryqueryover.md#join-entities-without-association-entity-joins-or-ad-hoc-joins)
   * [Aliases](queryqueryover.md#aliases)
   * [Projections](queryqueryover.md#projections)
   * [Projection Functions](queryqueryover.md#projection-functions)
   * [Entities Projection](queryqueryover.md#entities-projection)
   * [Sub-queries](queryqueryover.md#sub-queries)
* [Linq Queries](querysql.md#linq-queries)
   * [Structure of a Query](querysql.md#structure-of-a-query)
   * [Parameter types](querysql.md#parameter-types)
   * [Supported methods and members](querysql.md#supported-methods-and-members)
      * [Common methods](querysql.md#common-methods)
      * [DateTime and DateTimeOffset](querysql.md#datetime-and-datetimeoffset)
      * [ICollection, non generic and generic](querysql.md#icollection-non-generic-and-generic)
      * [IDictionary, non generic and generic](querysql.md#idictionary-non-generic-and-generic)
      * [Mathematical functions](querysql.md#mathematical-functions)
      * [Nullables](querysql.md#nullables)
      * [Strings](querysql.md#strings)
   * [Future results](querysql.md#future-results)
   * [Fetching associations](querysql.md#fetching-associations)
   * [Modifying entities inside the database](querysql.md#modifying-entities-inside-the-database)
      * [Inserting new entities](querysql.md#inserting-new-entities)
      * [Updating entities](querysql.md#updating-entities)
      * [Deleting entities](querysql.md#deleting-entities)
   * [Query cache](querysql.md#query-cache)
   * [Extending the Linq to NHibernate provider](querysql.md#extending-the-linq-to-nhibernate-provider)
      * [Adding SQL functions](querysql.md#adding-sql-functions)
      * [Adding a custom generator](querysql.md#adding-a-custom-generator)
* [Native SQL](query_sql.md#native-sql)
   * [Using an ISQLQuery](query_sql.md#using-an-isqlquery)
      * [Scalar queries](query_sql.md#scalar-queries)
      * [Entity queries](query_sql.md#entity-queries)
      * [Handling associations and collections](query_sql.md#handling-associations-and-collections)
      * [Returning multiple entities](query_sql.md#returning-multiple-entities)
         * [Alias and property references](query_sql.md#alias-and-property-references)
      * [Returning non-managed entities](query_sql.md#returning-non-managed-entities)
      * [Handling inheritance](query_sql.md#handling-inheritance)
      * [Parameters](query_sql.md#parameters)
   * [Named SQL queries](query_sql.md#named-sql-queries)
      * [Using return-property to explicitly specify column/alias names](query_sql.md#using-return-property-to-explicitly-specify-columnalias-names)
      * [Using stored procedures for querying](query_sql.md#using-stored-procedures-for-querying)
         * [Rules/limitations for using stored procedures](query_sql.md#ruleslimitations-for-using-stored-procedures)
   * [Custom SQL for create, update and delete](query_sql.md#custom-sql-for-create-update-and-delete)
   * [Custom SQL for loading](query_sql.md#custom-sql-for-loading)
* [Filtering data](filters.md#filtering-data)
   * [NHibernate filters](filters.md#nhibernate-filters)
* [Improving performance](performance.md#improving-performance)
   * [Fetching strategies](performance.md#fetching-strategies)
      * [Working with lazy associations](performance.md#working-with-lazy-associations)
      * [Tuning fetch strategies](performance.md#tuning-fetch-strategies)
      * [Single-ended association proxies](performance.md#single-ended-association-proxies)
      * [Initializing collections and proxies](performance.md#initializing-collections-and-proxies)
      * [Using batch fetching](performance.md#using-batch-fetching)
      * [Using subselect fetching](performance.md#using-subselect-fetching)
   * [The Second Level Cache](performance.md#the-second-level-cache)
      * [Cache mappings](performance.md#cache-mappings)
      * [Strategy: read only](performance.md#strategy-read-only)
      * [Strategy: read/write](performance.md#strategy-readwrite)
      * [Strategy: nonstrict read/write](performance.md#strategy-nonstrict-readwrite)
   * [Managing the caches](performance.md#managing-the-caches)
   * [The Query Cache](performance.md#the-query-cache)
   * [Understanding Collection performance](performance.md#understanding-collection-performance)
      * [Taxonomy](performance.md#taxonomy)
      * [Lists, maps, idbags and sets are the most efficient collections to update](performance.md#lists-maps-idbags-and-sets-are-the-most-efficient-collections-to-update)
      * [Bags and lists are the most efficient inverse collections](performance.md#bags-and-lists-are-the-most-efficient-inverse-collections)
      * [One shot delete](performance.md#one-shot-delete)
   * [Batch updates](performance.md#batch-updates)
   * [Multi Query](performance.md#multi-query)
   * [Multi Criteria](performance.md#multi-criteria)
* [Toolset Guide](toolsetguide.md#toolset-guide)
   * [Schema Generation](toolsetguide.md#schema-generation)
      * [Customizing the schema](toolsetguide.md#customizing-the-schema)
      * [Running the tool](toolsetguide.md#running-the-tool)
* [Example: Parent/Child](example-parentchild.md#example-parentchild)
   * [A note about collections](example-parentchild.md#a-note-about-collections)
   * [Bidirectional one-to-many](example-parentchild.md#bidirectional-one-to-many)
   * [Cascading lifecycle](example-parentchild.md#cascading-lifecycle)
   * [Using cascading Update()](example-parentchild.md#using-cascading-update)
   * [Conclusion](example-parentchild.md#conclusion)
* [Example: Weblog Application](example-weblog.md#example-weblog-application)
   * [Persistent Classes](example-weblog.md#persistent-classes)
   * [NHibernate Mappings](example-weblog.md#nhibernate-mappings)
   * [NHibernate Code](example-weblog.md#nhibernate-code)
* [Example: Various Mappings](example-mappings.md#example-various-mappings)
   * [Employer/Employee](example-mappings.md#employeremployee)
   * [Author/Work](example-mappings.md#authorwork)
   * [Customer/Order/Product](example-mappings.md#customerorderproduct)
* [Best Practices](best_practices.md#best-practices)

**NHibernateContrib Documentation**

* [Preface](contrib-preface.md#preface)
* [NHibernate.Caches](caches.md#nhibernatecaches)
   * [How to use a cache?](caches.md#how-to-use-a-cache)
   * [Prevalence Cache Configuration](caches.md#prevalence-cache-configuration)
   * [SysCache Configuration](caches.md#syscache-configuration)
   * [SysCache2 Configuration](caches.md#syscache2-configuration)
      * [Table-based Dependency](caches.md#table-based-dependency)
      * [Command-Based Dependencies](caches.md#command-based-dependencies)
      * [Aggregate Dependencies](caches.md#aggregate-dependencies)
      * [Additional Settings](caches.md#additional-settings)
   * [EnyimMemcached Configuration](caches.md#enyimmemcached-configuration)
   * [RtMemoryCache Configuration](caches.md#rtmemorycache-configuration)
   * [CoreMemoryCache Configuration](caches.md#corememorycache-configuration)
   * [CoreDistributedCache Configuration](caches.md#coredistributedcache-configuration)
      * [Memcached distributed cache factory](caches.md#memcached-distributed-cache-factory)
      * [Redis distributed cache factory](caches.md#redis-distributed-cache-factory)
      * [SQL Server distributed cache factory](caches.md#sql-server-distributed-cache-factory)
      * [Memory distributed cache factory](caches.md#memory-distributed-cache-factory)
* [NHibernate.Mapping.Attributes](mapping-attributes.md#nhibernatemappingattributes)
   * [What's new?](mapping-attributes.md#whats-new)
   * [How to use it?](mapping-attributes.md#how-to-use-it)
   * [Tips](mapping-attributes.md#tips)
   * [Known issues and TODOs](mapping-attributes.md#known-issues-and-todos)
   * [Developer Notes](mapping-attributes.md#developer-notes)
