//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by AsyncGenerator.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------


using NUnit.Framework;

namespace NHibernate.Test.NHSpecificTest.NH1403
{
	using System.Threading.Tasks;
	[TestFixture]
	public class FixtureAsync : BugTestCase
	{
		[Test]
		public async Task BugAsync()
		{
			Hobby h = new Hobby("Develop software");
			Person p = new Male("Diego");
			h.Person = p;
			Hobby h1 = new Hobby("Drive Car");
			Person p1 = new Female("Luciana");
			h1.Person = p1;
			object savedIdMale;
			object saveIdFemale;
			using (ISession s = OpenSession())
			using(ITransaction t = s.BeginTransaction())
			{
				savedIdMale = await (s.SaveAsync(h));
				saveIdFemale = await (s.SaveAsync(h1));
				await (t.CommitAsync());
			}

			using (ISession s = OpenSession())
			using (ITransaction t = s.BeginTransaction())
			{
				h = await (s.GetAsync<Hobby>(savedIdMale));
				h1 = await (s.GetAsync<Hobby>(saveIdFemale));
				Assert.IsTrue(h.Person is Male);
				Assert.IsTrue(h1.Person is Female);
				await (s.DeleteAsync(h));
				await (s.DeleteAsync(h1));
				await (t.CommitAsync());
			}
		}
	}
}