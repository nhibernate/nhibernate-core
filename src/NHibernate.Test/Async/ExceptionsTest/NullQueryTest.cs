//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by AsyncGenerator.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------


using System;
using System.Collections;
using System.Data;
using System.Data.Common;
using NHibernate.Exceptions;
using NUnit.Framework;

namespace NHibernate.Test.ExceptionsTest
{
	using System.Threading.Tasks;
	/// <summary>
	/// NH-1997
	/// </summary>
	[TestFixture]
	public class NullQueryTestAsync : TestCase
	{
		#region Overrides of TestCase

		protected override string[] Mappings
		{
			get { return Array.Empty<string>(); }
		}

		#endregion
		[Test]
		public async Task BadGrammarAsync()
		{
			ISession session = OpenSession();
			var connection = session.Connection;
			try
			{
				var ps = connection.CreateCommand();
				ps.CommandType = CommandType.Text;
				ps.CommandText = "whatever";
				await (ps.ExecuteNonQueryAsync());
			}
			catch (Exception sqle)
			{
				Assert.DoesNotThrow(
					() => ADOExceptionHelper.Convert(Sfi.SQLExceptionConverter, sqle, "could not get or update next value", null));
			}
			finally
			{
				session.Close();
			}
		}
	}
}
